## Общее описание процесса актуализации и анализа данных


### Библиотеки. R
Скрипт написан на языке **R**. Список библиотек и их применение:
```R
library(tidyverse) #основная обработка данных и графика
library(timeDate) #приведение даты к последнему дню месяца
library(scales) #процентная и временная шкала
library(RColorBrewer) #палитра
library(extrafont) #работа со шрифтом PT Sans
library(xlsx) #сохранение в формате Excel
library(mailR) #отправка почты из R
```


### Алгоритм работы:
1. Исходные данные - реестр ГП на [сайте ФГИУ](http://www.spfu.gov.ua/ua/content/spf-stateproperty-Subiekti-gospodaruvannya.html)
2. Загрузка информации о количестве электронных кабинетов с портала [e-data](http://spending.gov.ua/web/guest/disposers)
3. Сопоставление двух списков, перенос информации о новых регистрациях в **case_register.csv**
4. Сохранение реестра ГП в формате xls для экспорта в Tableau
5. Преобразование данных и расчеты для графика (количество регистраций по месяцам)
6. Сохранение графика в формате jpg
7. Отправка письма через [mailR](https://github.com/rpremraj/mailR) с вложенным рисунком и excel-файлом

>PS. Файл **orgID_import.R** отвечает за перенос в основную БД поля *orgID*, которое участвует  в формировании ссылки на кабинеты зарегистрированных предприятий на e-data. Это информация получена из третьих источников и обновляется нерегулярно. 


Подробные комметарии приведены прямо по ходу в файле **main.R**. Файлы **tableau_register.xlsx** и **dp_on_edata.jpg** создаются в процессе работы скрипта. Исходный файл **case_register.csv** перезаписывается при обновлении.


### Результат работы алгоритма (график)
![Реєстрація ДП на edata](https://raw.githubusercontent.com/woldemarg/edata_register/master/dp_on_edata.jpg)
